% !TEX root = ../notes.tex

We now consider stability of the equation. Consider $u_t - ku_{xx} = 0$ for $0 < x <\ell$ and $t > 0$ with initial and boundary conditions of $u(x, 0) = \Phi(x)$ and $u(0, t) = u(L, t) = 0$. Let $u_1(x, 0) = \Phi_1(x)$ and $u_2(x, t) = \Phi_2(x)$ we solutions of the equations. Call $w = u_1(x, t) - u_2(x, t)$ with the intial condition of $\Phi(x) = \Phi_1(x) + \Phi_2(x)$. Then from the energy method,
$$ \int_0^L \left(u_1(x, t) - u_2(x,t)\right)^2 dx \le \int_0^L \left( \Phi_1(x) - \Phi_2(x)\right)^2 $$
The LHS is the nearness of the solutions at any later time and the RHS is the nearness of the initial data for two solutions. Stability means that if we stay near a point if we just change it a little bit. Therefore, the solution of the diffusion equation is stable. \\

\noindent
\subsection{Diffusion Equation on the real line}
The problem of interest is $u_t - ku_{xx} = 0$ for $-\infty < x < \infty$ with initial condition of $u(x, 0) = \Phi$. We consider the invariance properties,
\begin{enumerate}
  \item The translate $u(x - y, t)$ for any solution is another solution for any fixed $y$.
  \item Any derivative, $u_x$, $u_t$, $u_{xx}$, etc. of a solution is again a solution.
  \item A linear combination of solutions of the diffusion equation is a solution of the diffusion equation.
  \item An integral of a solution is again a solution. Thus if $S(x, t)$ is a solution to the diffusion equation, then so is $S(x - y, t)$ and so is,
  $$ v(x, t) = \int_{-\infty}^\infty S(x-y, t)g(y)dy $$
  for any $g(y)$, as long as this convolution converges properly.
  \item If $u(x, t)$ is a solution of the diffusion equation, then the dilated function $u(\sqrt a x, at)$ for any $a > 0$ is also a solution.
  \begin{proof}
    Let $v(x, t) = u(\sqrt a, at)$, then $v_t = au_t$ and $v_{x} = \sqrt a u_x$ and so $v_{xx} = au_{xx}$. Therefore, $v_t - kv_{xx} = a(u_t - ku_{xx}) = 0$
  \end{proof}
\end{enumerate}

\noindent
Consider $Q_t - kQ_{xx} = 0$ with special initial conditions, such that $Q(x, 0) = 1$ for $x > 0$ and $Q(x, 0) = 0$ for $x < 0$. We let $Q(x, t) = g(p)$ where $p = \frac{x}{\sqrt{4kt}}$. We can see that $\frac{x}{\sqrt t} \to \frac{\sqrt a x}{\sqrt{at}}$ via dilation. This is now just $\frac{\sqrt a}{\sqrt a} \frac{x}{\sqrt t}$.
We will now use this form to transform the PDE to an ODE. We see that $Q_t = \di g p\pd p t = -\frac{1}{2t}\frac{x}{\sqrt{4kt}}\di g p$ and also $Q_x = \di g p \pd p x = \frac{1}{\sqrt{4kt}} g'(p)$ and $Q_{xx} = \frac{1}{4kt}g''(p)$. Then we get the following ODE,
$$ \frac{1}{t}\left( - \frac{1}{2}pg'(p) - \frac{1}{4}g''(p) \right) = 0 $$
which is just,
$$ g''(p) + 2pg'(p) = 0 $$
and then we can solve this and get a solution of,
$$ g'(p) = c_1e^{-p^2} $$
and then we integrate again to get an solution in terms of $g$
$$ g(p) = c_1\int e^{-p^2}dp + c_2 $$
But $Q(x, t) = g(p)$ and so
$$ Q(x, t) = c_1\int_0^{\frac{x}{\sqrt{4kt}}} e^{-p^2} + c_2 $$
We now want to impose initial conditions to get the constants. If $x > 0$, then,
\begin{equation}
  1 = \lim_{t \to 0} Q(x, t) = c_1\int_0^\infty e^{-p^2}dp + c_2 \label{equ:diff1}
\end{equation}
and impose the second condition, if $x < 0$, then
\begin{equation}
  0 = \lim_{t \to 0} Q(x, t) = c_1 \int_0^{-\infty} e^{-p^2}dp + c_2 \label{equ:diff2}
\end{equation}
We now will find the closed form of the gaussian integral. Let $I = \int_0^\infty e^{-x^2}dx$ and so,
\begin{align*}
  I^2 &= \int_0^\infty e^{-x^2}dx\int_0^\infty e^{-y^2}dy\\
  &= \int_0^\infty\int_0^\infty e^{-(x^2 + y^2)}dxdy \\
  &= \int_0^{\frac{\pi }{2}}\int_0^\infty e^{-r^2}rdrd \theta\\
  &= \int_0^{\frac{\pi }{2}} \left.-\frac{1}{2}e^{-r^2}\right|_{0}^\infty d\theta \\
  &= \int_0^{\frac{\pi }{2}} \frac{1}{2}d \theta = \frac{\pi}{4}
\end{align*}
Therefore, we can say that $I = \frac{\sqrt{\pi}}{2}$. From here we can say that (\ref{equ:diff1}) is, $c_1 \frac{\sqrt \pi}{2} + c_2$ and (\ref{equ:diff2}) becomes $-c_1 \frac{\sqrt \pi}{2} + c_2$. We solve these and see that $c_1 = \frac{1}{\sqrt \pi}$ and $c_2 = \frac{1}{2}$.
We can now substitute these into the solution for the equation,
$$ Q(x, t) = \frac{1}{2} + \frac{1}{\sqrt \pi} \int_0^{\frac{x}{\sqrt{4kt}}} e^{-p^2}dp \qquad t > 0 $$
If $Q(x, t)$ is a solution, then $S(x, t) = \pd Q x$ is a solution. Then using the convolution integral, the following is also a solution,
\begin{equation}
  u(x, t) = \int_{-\infty}^\infty S(x - y, t)\Phi(y) dy \qquad t > 0 \tag{$*$}\label{equ:diff3}
\end{equation}
Furthermore, we claim this is unique. It suffices to show it satisfies the original initial condition.
\begin{align*}
  u(x, t) &= \int_{-\infty}^\infty S(x - y, t)\Phi(y)dy \\
  &= \int_{-\infty}^\infty \pd Q x (x - y, t) \Phi(y)dy \\
  &= -\int_{-\infty}^\infty \pd Q y (x - y, t) \Phi(y)dy \\
  &= \left.-Q(x - y, t)\Phi(y)\right|_{-\infty}^\infty + \int_{-\infty}^\infty Q(x - y, t)\Phi'(y)dy
\end{align*}
We now impose the initial condition, $\Phi(y) \to 0$ as $|y|$ becomes large. Therefore,
$$ u(x, t) = \int_{-\infty}^\infty Q(x - y, t)\Phi'(y)dy $$
Now let $t = 0$, then,
$$ u(x, 0) = \int_{-\infty}^\infty Q(x - y, 0)\Phi'(y)dy $$
We also have initial conditions for $Q$, then,
$$ u(x, 0) = \int_{-\infty}^x \Phi'(y)dy = \Phi(x) $$
We said that $S(x, t) = \pd Q x = \frac{1}{2\sqrt{\pi k t}} e^{-\frac{x^2}{4kt}}$ for $t > 0$ (this is also known as Greens function). Now substituting in for the source function into (\ref{equ:diff3}), we can conclude,
$$ u(x, t) = \frac{1}{\sqrt{4\pi kt}}\int_{-\infty}^\infty e^{\frac{-(x - y)^2}{4kt}}\Phi(y)dy $$
We also note that,
$$ \int_{-\infty}^\infty S(x, t)dt = \int_{-\infty}^\infty \frac{1}{\sqrt \pi} e^{-q^2}dq = 1 $$
We can't always talk about the solution in terms of elementary functions, but we are able to write it in terms of $\erf x$, which is defined as,
$$ \erf x = \frac{2}{\sqrt \pi} \int_0^x e^{-p^2}dp $$

\begin{eg}
  $Q(x, t)$ can be written in terms of $\erf x$ as,
  $$ Q(x, t) = \frac{1}{2}\erf\left( \frac{x}{\sqrt{4kt}} \right) $$
\end{eg}

\begin{eg}
  Solve,
  $$ \begin{cases}
    u_t - ku_{xx} = 0\\
    u(x, 0) = e^x
  \end{cases} $$
  We already have a solution, we just have to replace $\Phi$ by the initial condition.
  $$ u(x, t) = \frac{1}{\sqrt{4\pi kt}}\int_{-\infty}^\infty  e^{-\frac{(x - y)^2}{4kt}}e^{-y}dy = \frac{1}{\sqrt{4\pi kt}}e^{-\frac{(y - x - 2kt)^2}{4kt} + kt - x}$$
  and so we now let $p = \frac{y + 2kt - x}{\sqrt{4kt}}$, then,
  $$ u(x, t) = \frac{1}{\pi}e^{kt - x}\int_{-\infty}^\infty e^{-p^2}dp = e^{kt - x} $$
\end{eg}

\subsection{Diffusion on the half line}
We consider $v_t - kv_{xx} = 0$ on $0 < x < \infty$ for $t > 0$ subject to initial condition $u(x, 0) = \Phi(x)$ for $t = 0$ and $x > 0$ and Dirichlet Boundary condition, $v(0, t) = 0$. We need to restrict the equation, so we will consider the method of reflection or odd expansion. We will use odd expansion, consider $$\Phi_\text{odd} = \begin{cases}
  \Phi(x) & x > 0 \\
  0 & x = 0 \\
  -\Phi(-x) & x < 0
\end{cases}$$

Our problem of interest is $u_t - ku_{xx} = 0$ for $- \infty < x < \infty$ and $t > 0$ subject to $u(x, 0) = \Phi_\text{odd}(x)$. Then the solution to this is,
$$ u(x, t) = \int_{-\infty}^\infty S(x - y, t)\Phi_\text{odd}(y)dy $$
where $v(x, t) = u(x, t)$ for $x > 0$. We can write,
\begin{align*}
  u(x, t) &= \int_0^\infty S(x - y, t)\Phi(y)dy - \int_{-\infty}^0 S(x - y, t)\Phi(-y)dy \\
  &= \int_0^\infty S(x - y, t)\Phi(y)dy - \int^{\infty}_0 S(x + y, t)\Phi(y)dy \\
  &= \int_0^\infty \left(S(x - y, t) - S(x + y, t)\right)\Phi(y)dy \\
\end{align*}
Therefore,
$$ v(x, t) = \frac{1}{\sqrt{4\pi kt}}\int_0^\infty \left(e^{-\frac{(x - y)^2}{4kt}} - e^{-\frac{(x + y)^2}{4kt}}\right) \Phi(y)dy $$
\begin{eg}
  Solve the diffusion equation, $v_t - kv_{xx} = 0$ for $0 < x < \infty$ and $t > 0$ subject to $v(x, 0) = 1$ at $t = 0$ and $v(0, t) = 0$ at $x = 0$.\\

  \noindent
  We get the solution of,
  $$ v(x, t) = \frac{1}{\sqrt{4\pi kt}}\int_0^\infty \left(e^{-\frac{(x - y)^2}{4kt}} - e^{-\frac{(x + y)^2}{4kt}}\right) dy $$
  We then change variables, let $p = \frac{x - y}{\sqrt{4kt}}$ and $q = \frac{x + y}{\sqrt{4kt}}$, then we get,
  $$ v(x, t) = -\frac{1}{\sqrt{\pi }}\int_{\frac{x}{\sqrt{4kt}}}^{-\infty} e^{-p^2} dp - \frac{1}{\sqrt{\pi}}\int_{\frac{x}{\sqrt{4kt}}}^{\infty} e^{-q^2} dq $$
  Then we get,
  $$ v(x, t) = \frac{1}{\sqrt \pi}\int_{-\infty}^0 e^{-p^2}dp + \frac{1}{\sqrt \pi}\int_0^{\frac{x}{\sqrt{4kt}}}e^{-p^2}dp + \frac{1}{\sqrt \pi}\int^{\frac{x}{4kt}}_0 e^{-q^2}dq - \frac{1}{\sqrt\pi} \int_0^\infty e^{-q^2}dq $$
  and the first and last terms cancel,
  $$ v(x, t) = \frac{1}{\sqrt \pi}\int_0^{\frac{x}{\sqrt{4kt}}}e^{-p^2}dp + \frac{1}{\sqrt \pi}\int^{\frac{x}{4kt}}_0 e^{-q^2}dq $$
  which is just a $\erf$ functions,
  $$ \erf \left(\frac{x}{\sqrt{4kt}}\right) $$
\end{eg}

\noindent
Now consider a Neumnann Boundary condition,
\begin{eg}
  Consider $w_t - kw_{xx} = 0$ on the half line where $w(x, 0) = \Phi(x)$ and subject to $w_x(0, t) = 0$. For the Neumann problem we need to use the even extension as then we will get it's derivative as an odd function. Consider,
  $$ \Phi_\text{even}(x) = \begin{cases}
    \Phi(x) & x \ge 0 \\
    \Phi(-x) & x < 0
  \end{cases} $$
  We consider $u_t - ku_{xx} = 0$ where $u(x, 0) = \Phi_\text{even}(x)$. We restrict this to $x > 0$ this will be the unique solution. We start with the solution on the entire real line, then,
  $$ u(x, t) = \int_{-\infty}^\infty S(x - y, t)\Phi_\text{even}dy $$
  Then we break it into two parts,
  \begin{align*}
    u(x, t) &= \int_{0}^\infty S(x - y, t)\Phi(y)dy + \int_{-\infty}^0 S(x - y, t)\Phi(-y)dy\\
    &= \int_{0}^\infty S(x - y, t)\Phi(y)dy + \int^{\infty}_0 S(x + y, t)\Phi(y)dy\\
    &= \int_{0}^\infty \left(S(x - y, t) + S(x + y, t)\right)\Phi(y)dy\\
  \end{align*}
  Then we have that,
  $$ w(x, t) = \frac{1}{\sqrt{4\pi kt}}\int_0^\infty \left(e^{-\frac{(x - y)^2}{4kt}} + e^{-\frac{(x + y)^2}{4kt}}\right)\Phi(y) dy $$
\end{eg}

\begin{eg}
  Solve $w_t - kw_{xx} = 0$ for the half line where $w(x, 0) = \Phi(x) = 1$ and $w_x(0, t) = 0$. Then even extension of $\Phi_{\text{even}}(x) = \Phi(x)$. So we know $w(x, t) = u(x, t)$ for $x > 0$. Therefore, we have the solution,
  $$ u(x, t) = \frac{1}{\sqrt{4\pi kt}}\int_0^\infty \left(e^{-\frac{(x - y)^2}{4kt}} + e^{-\frac{(x + y)^2}{4kt}}\right)dy $$
  Let $p = \frac{x - y}{\sqrt{4kt}}$ and $q = \frac{x + y}{4kt}$,
  $$ u(x, t) = \frac{1}{\sqrt \pi}\int_{\frac{x}{\sqrt{4kt}}}^{-\infty} e^{-p^2}dp + \frac{1}{\sqrt \pi} \int_{\frac{x}{\sqrt{4kt}}}^{\infty} e^{-q^2}dq $$
  Then we can further simplify as before, and we get,
  $$ \int_{-\infty}^\infty \frac{1}{\sqrt{\pi}}e^{-p^2} = 1 $$
\end{eg}

\noindent
We consider the diffusion equation with a source,
\subsection{Diffusion Equation with a source equation}
$u_t - ku_{xx} = f(x, t)$ where $-\infty < x < \infty$, $t > 0$ and $k > 0$ where $u(x, 0) = \Phi(x)$. When $f(x, t) = 0$, then we get,
$$ u(x, t) = \int_{-\infty}^\infty S(x - y, t)\Phi(y)dy $$
Then with $f(x, t) \ne 0$, we get that,
$$ u(x, t) = \int_{-\infty}^\infty S(x - y, t)\Phi(y)dy + \int_0^t \int_{-\infty}^\infty S(x - y, t - s)f(y, s)dyds$$
For simplicity, we let $\Phi(x) = 0$. Then we need to find that,
\begin{align*}
  \pd u t &= \pd{}{t}\int_0^t \int_{-\infty}^{\infty} S(x - y, t - s)f(y, s)dyds\\
  &= \int_0^t \int_{-\infty}^{\infty} \pd{}{t}S(x - y, t - s)f(y, s)dyds + \lim_{s \to t}\int_{-\infty}^\infty S(x - y, t - s)f(y, s)dy\\
  &= \int_0^t \int_{-\infty}^\infty k\pdd{}{x}S(x - y, t - s)f(y,s)dyds + \lim_{s \to t}\int_{-\infty}^\infty S(x - y, t - s)f(y, s)dy
\end{align*}
\begin{align*}
  &= \int_0^t \int_{-\infty}^\infty k\pdd{}{x}S(x - y, t - s)f(y,s)dyds + \int_{-\infty}^\infty S(x - y, \e)f(y, t)dy \\
  &= \int_0^t \int_{-\infty}^\infty k\pdd{}{x}S(x - y, t - s)f(y,s)dyds + \int_{-\infty}^\infty \pd Q x(x - y, \e)f(y, t)dy \\
  &= \int_0^t \int_{-\infty}^\infty k\pdd{}{x}S(x - y, t - s)f(y,s)dyds - \int_{-\infty}^\infty \pd Q y(x - y, \e)f(y, t)dy \\
  &= \int_0^t \int_{-\infty}^\infty k\pdd{}{x}S(x - y, t - s)f(y,s)dyds -\left[ - Q(x - y, \e)f(y, t) \right]_{y = -\infty}^{y = \infty} + \int_{-\infty}^\infty Q(x - y, \e)\pd f ydy \\
  &= \int_0^t \int_{-\infty}^\infty k\pdd{}{x}S(x - y, t - s)f(y,s)dyds + \int_{-\infty}^\infty Q(x - y, \e)\pd f y dy \\
\end{align*}
\noindent
Consider as $\e \to 0$ and we consider the initial conditions for $Q$,
\begin{align*}
  &= \int_{-\infty}^x \pd f y dy = f(x)
\end{align*}
and so we can write that,
\begin{align*}
  \pd u t &= k\pdd{}{x}\int_0^t \int_{-\infty}^\infty S(x - y, t - s)f(y, s)dyds + f(x, t) \\
  \pd u t &= k\pdd u x + f(x, t)
\end{align*}
\noindent
Therefore it satisfies the given PDE and so now we need to show it satisfies the initial condition. Therefore,
\begin{align*}
  u(x, 0) &= \int_{-\infty}^\infty S(x - y, 0)\Phi(y)dy + 0 \\
  &= \Phi(x)
\end{align*}
Then substituting into the source function $S(x, t)$, we get that,
\begin{align*}
  u(x, t) &= \int_0^t \int_{-\infty}^\infty S(x - y, t - s)f(y, s)dyds \\
  &= \int_0^t \int_{-\infty}^\infty \frac{1}{\sqrt{4\pi k (t - s)}}e^{\frac{-(x - y)^2}{4k(t - s)}} f(y, s)dy ds
\end{align*}
If $\Phi(x) \ne 0$, then we get,
$$ \int_0^t \int_{-\infty}^\infty \frac{1}{\sqrt{4\pi k (t - s)}}e^{\frac{-(x - y)^2}{4k(t - s)}} f(y, s)dy ds + \int_{-\infty}^\infty \frac{1}{\sqrt{4\pi k t}}e^{-\frac{(x - y)^2}{4kt}}\Phi(y)dy $$

\noindent
\begin{eg}
  Use the method of reflection to solve the inhomogeneous diffusion equation on the half-line with Dirichlet boundary condition
  $$ \begin{cases}
    u_t - ku_{xx} = f(x, t)\\
    u(0, t) = 0, u(x, 0) = \Phi(x)
  \end{cases} $$
  We consider the odd extensions of $\Phi$ and $f$. We denote them as $f_{\text{odd}}$ and $\Phi_\text{odd}$. Then we use the laws of integration to simplify the answer to,
  $$ v(x, t) = \int_0^\infty \left(S(x - y, t - s) - S(x + y, t - s)\right)\Phi(y)dy + \int_0^t \int_{-\infty}^\infty \left( S(x - y, t - s) - S(x + y, t - s) \right) dyds $$
\end{eg}

\section{Fourier Series}
The Fourier Series of a function on an interval $[-\pi, \pi]$ is,
$$ f(x) = \frac{a_0}{2} + \int_{k=1}^\infty a_k\cos kx + b\sin kx $$
where we define,
$$ a_k = \ip{f(x)}{\cos kx} = \frac{1}{\pi}\int_{-\pi}^\pi f(x)\cos kx $$
$$ b_k = \ip{f(x)}{\sin kx} = \frac{1}{\pi}\int_{-\pi}^\pi f(x)\sin kx $$
Where we use the $L-2$ inner product on function spaces. This is defined as,
$$ \ip f g = \frac{1}{\pi}\int_{-\pi}^\pi f(x)g(x)dx $$
We can now see that the trigonometric functions are orthogonal,
$$ \int_{-\pi}^\pi \cos (kx)\cos (\ell x) = \begin{cases}
  0 & k \ne \ell \\
  2\pi & k = \ell = 0\\
  \pi & k = \ell \ne 0
\end{cases} $$
and,
$$ \int_{-\pi}^\pi \cos(kx)\sin(\ell x)dx = 0 \qquad \forall k, \ell \ge 0$$
and
$$ \int_{-\pi}^\pi \sin (kx)\sin(\ell x) = \begin{cases}
  0 & k \ne \ell \\
  \pi & k = \ell \ne 0
\end{cases} $$
Therefore we that $\sin$ is orthogonal to $\sin$ and $\cos$ for $k \ne \ell$ and $\cos$ is orthogonal to $\cos$ for $k \ne \ell$. Furthermore, $\norm 1 = \sqrt 2$, $\norm {\cos kx} = 1$ and $\norm {\sin kx} = 1$ where $k \ne 0$.\\


\noindent
Consider $\ip{f(x)}{\cos \ell x}$,
\begin{align*}
   \ip{f(x)}{\cos \ell x} &= \ip{\frac{a_0}{2}}{\cos \ell x} + \sum_{k=1}^\infty a_k \ip{\cos kx}{\cos \ell x} + b_k\ip{\sin kx}{\cos \ell x}\\
   &= \ip{\frac{a_0}{2}}{\cos \ell x} + \sum_{k=1}^\infty a_k \ip{\cos kx}{\cos \ell x} \\
   &= \sum_{k=1}^\infty a_k \ip{\cos kx}{\cos \ell x} = a_\ell \\
\end{align*}
Therefore, $a_k = \ip{f(x)}{\cos kx}$. We can now prove a similar thing for $b_k$. \\

\noindent
Now assume $f$ is an even function, then we have the following,
$$ f(x) = \frac{a_0}{2} + \sum_{k=1}^\infty a_k\cos kx $$
as $b_k = \ip{f(x)}{\sin kx} = 0$. This is called the \textbf{Fourier Cosine Series}. If $f$ is an odd function, then we have a \textbf{Fourier Sine series},
$$ f(x) = \sum_{k=1}^\infty b_k \sin kx$$
We notice that in the sine and cosine series the coefficients double. That is in the Fourier Cosine series we have,
$$ a_k = \frac{2}{\pi}\int_{-\pi}^\pi f(x)\cos kx dx $$

\noindent
We know that $e^{ix} = \cos kx + i \sin kx$ and we also know that $\cos kx = \frac{1}{2}\left( e^{ikx} + e^{-ikx}\right)$ and $\sin kx = \frac{1}{2i}\left( e^{ikx} - e^{-ikx} \right)$. We cal also extend the $L-2$ norm to complex-valued functions,
$$ \ip f g = \frac{1}{2\pi}\int_{-\pi}^\pi f(x)\bar g(x) $$
Therefore we consider,
$$ \ip{e^{ikx}}{e^{-i\ell x}} = \frac{1}{2\pi}\int_{-\pi}^\pi e^{i(k - \ell)x}dx = \begin{cases}
  1 & k = \ell \\
  0 & k \ne \ell
\end{cases} $$
Therefore, the Fourier Series of the complex valued function is,
$$ f(x) = \sum_{k = -\infty}^\infty c_k e^{ikx} \qquad c_k = \ip{f(x)}{e^{ikx}} $$


\noindent
Finally if we have a domain of definition of $[-\ell, \ell]$ instead of $[-\pi, \pi]$ we can use a change of variables of $x = \frac{\ell}{\pi}y$ for $- \pi \le y \le \pi$. Then our Fourier Series becomes,
$$ f(x) = \frac{a_0}{2} + \sum_{k=1}^\infty a_k\cos \frac{k\pi}{\ell}x + b_k\sin \frac{k\pi}{\ell}x $$
where,
$$ a_k \frac{1}{\ell}\int_{-\ell}^\ell f(x)\cos \frac{k\pi}{\ell}x dx \qquad b_k = \frac{1}{\ell}\int_{-\pi}^\pi f(x)\sin \frac{k\pi}{\ell}x $$

\section{Seperation of Vairables}
We consider the diffusion equation, $u_t - u_{xx} = 0$ for $0 < x < \ell$ where $t > 0$ and $k > 0$. With boundary and initial conditions $u(0, t) = u(\ell, t) = 0$ and $u(x, 0) = f(x)$. We consider a solution of the form $u(x, t) = X(x)T(t) \ne 0$. Then we get that, the PDE reduces to $XT' - kX''T = 0$ then we can write that,
$$ \frac{T'}{T} = k \frac{X''}{X} = -\a^2 $$
As they are equal, they must equal a constant. Therefore,
$$ \frac{T'}{kT} = -\a^2 \qquad \frac{X''}{X} = -\a^2 $$
We then have the two ODEs, $T' + \a^2kT = 0$ and $X'' + \a^2X = 0$, therefore we have the solutions of $T(t) = ce^{-\a^2 kt}$ (We have $-\a^2$ as we want a solution that decays), which means $u(x, t) = e^{-\l t}X(t)$. We consider this as a solution, then $u_t = -\l e^{-\l t}X(x)$ and $u_{xx} = e^{-\l t}X''(x)$. We then have that $-e^{-\l t}(\l X + k X'') = 0$ and so we then have that $X'' + \frac{\l}{k}X = 0$.
We have the initial conditions of $u(0, t) = u(\ell, t) = 0$, that is $e^{-\l t}X(0) = e^{-\l t}X(\ell) = 0$ and so $X(0) = X(\ell) = 0$. We now solve the second order ODE with these boundary conditions.
$$ \begin{cases}
  kX'' + \l X = 0\\
  X(0) = X(\ell) = 0
\end{cases} $$
If $\l = 0$, then $\di X t = c$ and so $X(x) = Cx + D$, therefore $X(0) = D = 0$ and $X(\ell) = c\ell = 0$. Therefore, $X(x) = 0$, which is the trivial solution. Now consider $\ell < 0$, let $\l = -\b$ where $\b > 0$.  Therefore we get the ODE, $X'' - \frac{\b}{k}X = 0$, and so we have the solution $X(x) = c_1e^{\sqrt{\frac{\b}{k}}x} + c_2e^{-\sqrt{\frac{\b}{k}}x}$. Now impose boundary conditions,
$X(0) = c_1 + c_2 = 0 \implies c_1 = -c_2$ and so $X(\ell) = c_1e^{\sqrt{\frac{\b}{k}}\ell} + c_2e^{-\sqrt{\frac{\b}{k}}\ell} = 0$. Therefore, we get that $c_1 = 0$ and so $c_2 = 0$ as well so $X(x) = 0$. Now consider if $\l > 0$, then $X'' + \frac{\l}{k}X = 0$ and so we get,
$X(x) = c_1\cos \o x + c_2\sin \o x$ where $\o^2 = \frac{\l}{k}$. We impose the conditions and get that $X(0) = c_1 = 0$ and the second we get that $X(\ell) = c_2\sin \o\ell = 0$, so we let $\sin \o \ell = 0$ and so $\o_n \ell = n\pi$ where $n \in \Z$. We then have $\o_n = \frac{n\pi}{\ell}$, this is the eigenfrequency. Therefore $\l_n = k\o_n^2 = k\left( \frac{n\pi}{\ell} \right)^2$.
Now we can find the eigenfunctions. Therefore, $X_n(x) = \sin \frac{n\pi}{\ell}x$ for $n \in \Z$ are the eigenfunctions. The eigensolutions are,
$$ u_n(x, t) = X_n(x)T_n(t) = e^{-\l_n t}X_n(x) = e^{-\l_n t}\sin \frac{n\pi}{\ell} x $$
Therefore we have,
$$ u(x, t) = \sum_{n=1}^\infty c_n e^{-k \left( \frac{n\pi}{\ell} \right)^2 t}\sin \frac{n\pi}{\ell} x $$
Now we find $c_n$ by imposing the initial condition.
$$ u(x, 0) = \sum_{n=1}^\infty c_n\sin \frac{n\pi}{\ell} x = f(x) \qquad n \in \Z $$
This is a Fourier Sine series, so
$$ c_n = \frac{2}{\ell}\int_{0}^\ell f(x)\sin \frac{n\pi}{\ell}dx $$

\begin{eg}
  Consider $u_t - ku_{xx} = 0$ for $0 < x < \ell$ and $t > 0$ where $u(0, t) = 0$ and $u(\ell, t) = u_0$ subject to $u(x, 0) = f(x)$ for $0 < x < \ell$. We introduce that,
  $$ u(x, t) = v(x, t) + \frac{u_0x}{\ell} $$
  and then $u(0, t) = v(0, t) = 0$ and $u(\ell, t) = v(\ell, t) + u_0 = u_0$ and so $v(\ell, t) = 0$. We solve another PDE for $v(x, t)$, then we can find $u(x, t)$. We can quickly check that $u_t = v_t$ and $u_{xx} = v_{xx}$. Therefore the PDE problem is $v_t - kv_{xx} = 0$ for $0 < x < \ell$ and $t > 0$ where $v(0, t) = v(\ell, t) = 0$ subject to $v(x, 0) = u(x, 0 ) - \frac{u_0 x}{\ell} = f(x) - \frac{u_0 x}{\ell}$ for $0 < x < \ell$. We can now solve this.
  $$ v(x, t) = \sum_{n=1}^\infty v_n(x, t) = \sum_{n=1}^\infty c_n e^{-k\left( \frac{n\pi}{\ell} \right)^2 t}\sin \frac{n\pi}{\ell} x $$
  where
  $$c_n = \frac{2}{\ell}\int_0^\ell \left(f(x) - \frac{u_0x}{\ell}\right) \sin \frac{n\pi}{\ell}xdx.$$
  Therefore we get,
  $$ u(x, t)= \sum_{n=1}^\infty \left[ \frac{2}{\ell}\int_0^\ell \left(f(\t) - \frac{u_0\t}{\ell}\right) \sin \frac{n\pi}{\ell}\t d\t \right] e^{-k\left( \frac{n\pi}{\ell} \right)^2 t}\sin \frac{n\pi}{\ell} x + \frac{u_0x}{\ell}$$
\end{eg}

\subsection{Diffusion Equation with Neumann Boundary Condition}
Consider $u_t - ku_{xx} = 0$ for $0 < x < \ell$ where $t, k > 0$ with $u_x(0, t) = u_x(\ell, t) = 0$ for $u(x, 0) = \Phi(x)$. We have a solution of the form $u(x, t) = e^{-\l t}X(x)$, then we substitute this into the PDE, we get that $X'' + \frac{\l}{k}X = 0$ where $\l > 0$. This is just $X'' + \o^2 X = 0$ where $\o^2 =
\frac{\l}{k}$. We have that $X(x) = c_1\cos \o x + c_2\sin \o x$. Now we consider the boundary conditions, $u_x(0, t) = u_x(\ell, t) = 0$. That is $X'(0) = X'(\ell) = 0$. We consult our solution for $X(x)$ and get, $X'(x) = -c_1\o \sin\o x + c_2\o \cos \o x$ and so $X'(0) = c_2\o = 0$ and so $c_2 = 0$. Now $X'(\ell) = -c_1\o\sin \o \ell = 0$.
For non-trivial solutions $\sin \o\ell = 0$ and so $\o_n = \frac{n\pi}{\ell}$. Therefore, $\l_n = k\o_n^2 = k\left( \frac{n\pi}{\ell} \right)^2$. Therefore, $X(x) = c_n\cos \frac{n\pi}{\ell}x$. Therefore,
$$ u_n(x, t) = e^{-\l_n t}X_n(x) = e^{-k\left( \frac{n\pi}{\ell} \right)^2 t}\cos \frac{n\pi}{\ell }x $$
We also consider $\l = 0$, we then get another solution, $X(t) = D$. Therefore we have a solution (letting $D = \frac{1}{2}c_0$),
$$ u(x, t) = \frac{c_0}{2} + \sum_{n=1}^\infty c_ne^{-k\left( \frac{n\pi}{\ell} \right)^2 t}\cos \frac{n\pi}{\ell }x $$
Now we impose the initial conditions. Therefore,
$$ u(x, 0) = \frac{c_0}{2} + \sum_{n=1}^\infty c_n\cos \frac{n\pi}{\ell }x $$
and so we have that,
$$ c_n = \frac{2}{\ell}\int_0^\ell \cos \frac{n\pi}{\ell}x \Phi(x)dx  $$

