% !TEX root = ../notes.tex

\section{Spherical Pendulum}

We want to consider a pendulum in 3D space. We will think about this through the definition of spherical coordinates, as in actuality our motion of the bob will just be on $S^2$. However, we need to define what are Euler Lagrange equations?\\

\begin{minipage}{0.49\textwidth}
  Firstly, here is what the Euler Lagrange equations are,
  $$ \di {} {t} \pd{L}{\dot{q}^a} - \pd{L}{q^a} $$
  where we range through the different basis vectors $q^a$ and their associated derivatives $\dot q^a$.\\

  \noindent
  We also define $L$ as the Lagrangian. We define this simply as,
  $$ L(q, \dot q) = T(q, \dot q) - V(\vec r(q)) $$
  where further we define $T(q,\dot q)$ as the kinetic energy of the system and $V(\vec r(q))$ the potential energy of the system.
\end{minipage}
\begin{minipage}{0.49\textwidth}
  \begin{tikzpicture}
      % save length of g-vector and theta to macros
      \pgfmathsetmacro{\Gvec}{1.5}
      \pgfmathsetmacro{\myAngle}{30}
      % calculate lengths of vector components
      \pgfmathsetmacro{\Gcos}{\Gvec*cos(\myAngle)}
      \pgfmathsetmacro{\Gsin}{\Gvec*sin(\myAngle)}

      \coordinate (centro) at (0,0);
      \draw[dashed,gray,-] (centro) -- ++ (0,-3.5) node (mary) [black,below]{$ $};
      \draw[thick] (centro) -- ++(270+\myAngle:3) coordinate (bob);
      \pic [draw, ->, "$\theta$", angle eccentricity=1.5] {angle = mary--centro--bob};
      \draw [blue,-stealth] (bob) -- ($(bob)!\Gcos cm!(centro)$);
      \draw[blue, dotted, rotate around={-90/4 - 6:(0,-2.4)}] (0,-2.4) circle[x={(1,0)},y={(1,1)},x radius=1,y radius=1];
      \draw [-stealth] (bob) -- ($(bob)!-\Gcos cm!(centro)$)
        coordinate (gcos)
        node[midway,above right] {$a\cos\theta$};
      \draw [-stealth] (bob) -- ($(bob)!\Gsin cm!90:(centro)$)
        coordinate (gsin)
        node[midway,above left] {$a\sin\theta$};
      \draw [-stealth] (bob) -- ++(0,-\Gvec)
        coordinate (g)
        node[near end,left] {$g$};
      \pic [draw, ->, "$\theta$", angle eccentricity=1.5] {angle = g--bob--gcos};
      \filldraw [fill=black!40,draw=black] (bob) circle[radius=0.1];
  \end{tikzpicture}
\end{minipage}\vspace{10pt}
We are going to use polar coordinates to derive our system of equations. Note, that we are going to assume that our sphere, or pendulum rod, has radius of $1$.
\begin{align*}
  x &= \sin \theta \cos\phi \\
  y &= \sin\theta\sin\phi\\
  z &= 1 - \cos\theta
\end{align*}
Our first focus is $T(q, \dot q)$, which will just be $\frac{1}{2}mv^2$. We can see that $v = |\dot{\vec{r}}(t)|$ and so $v = \sqrt{\dot x^2 + \dot y^2 + \dot z^2}$. Hence, we now find what $v$ is and then find the lagrangian. Firstly, we note that,
$$ \di {} t (x(t)) = \pd{x}{\theta}\di {\theta}{t} + \pd{x}{\phi}\di \phi t $$
and similarly for $y(t)$ and $z(t)$. Hence,
\begin{align*}
  \di {x(t)} t &= \cos \theta \cos \phi \,\dot \theta - \sin \theta \sin \phi \,\dot \phi\\
  \di {y(t)} t &= \cos \theta\sin\phi \dot \theta + \sin \theta\cos \phi \dot \phi\\
  \di {z(t)} t &= \sin \theta\dot \theta
\end{align*}
and now we derive our $T(q, \dot q)$,
\begin{align*}
  T(q, \dot q) &= \frac{1}{2}m \bigg( \left(\cos \theta \cos \phi \,\dot \theta - \sin \theta \sin \phi \,\dot \phi\right)^2 + \\
  & \left( \cos \theta\sin\phi \dot \theta + \sin \theta\cos \phi \dot \phi \right)^2 + \\
  & \left( \sin \theta\dot \theta \right)^2 \bigg)
\end{align*}
which then can be simplified down to,
$$ T(\theta, \dot \theta, \phi, \dot \phi) = \frac{1}{2}m\left( \dot \theta^2 + \dot \phi ^2\sin^2 \theta \right) $$
and we note that our system has only one potential energy, gravitation potential! Hence,
$$ V(\theta, \dot \theta, \phi, \dot \phi) = mgz = mg(1 - \cos \theta) $$
Hence, we can now talk about Lagrangian explicitly,
$$ L(\theta, \dot \theta, \phi, \dot \phi) = \frac{1}{2}m \left( \dot \theta^2 + \dot\phi^2\sin^2 \theta - 2g\left(1 - \cos \theta\right) \right) $$
Finally, we can now take derivatives of this function and produce the Euler Lagrange equations. We need to find the basis vectors, $\theta$ and $\phi$, as we have two basis vectors, we will have two equations. Firstly, $\theta$
\begin{align*}
  \di {} t \pd{L}{\dot\theta} - \pd{L}{\theta} = \di {} t {m \dot \theta} + \left( mg\sin\theta + m\sin \theta \cos \theta \,\dot\phi^2 \right) &= 0\\
  m\ddot{\theta} + mg\sin \theta - m\sin \theta \cos \theta\,\dot \phi^2  &= 0\\
  \ddot{\theta} + g\sin \theta - \sin \theta \cos \theta\,\dot \phi^2  &= 0\\
\end{align*}
and secondly, $\phi$
\begin{align*}
  \di {} t \pd{L}{\dot\phi} - \pd{L}{\phi} = \di {} t {m \dot \theta} (m \dot \phi \sin^2 \theta) &= 0\\
  m\ddot\phi\sin^2 \theta + 2m\dot \phi \sin \theta\cos \theta &= 0\\
  \ddot\phi\sin \theta + 2\dot \phi\cos \theta &= 0\\
\end{align*}
We have derived the Euler-Lagrange equations for the spherical pendulum, which are
$$ \begin{cases}
  \quad\ddot{\theta} + g\sin \theta - \sin \theta \cos \theta\,\dot \phi^2  = 0\\
  \quad\ddot\phi\sin \theta + 2\dot \phi\cos \theta = 0
\end{cases} $$
